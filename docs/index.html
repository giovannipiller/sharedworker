<!doctype html><html class="default"><head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="IE=edge"><title>@okikio/sharedworker - v1.0.3</title><meta name="description" content="Documentation for @okikio/sharedworker - v1.0.3"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="assets/style.css"><link rel="stylesheet" href="assets/highlight.css"><link rel="stylesheet" href="assets/custom.css"><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@okikio/sharedworker - v1.0.3</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1 id="okikiosharedworker---v103">@okikio/sharedworker - v1.0.3</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#okikiosharedworker" id="okikiosharedworker" style="color: inherit; text-decoration: none;">
  <h1 id="okikiosharedworker">@okikio/sharedworker</h1>
</a>
<p><a href="https://bundle.js.org/?q=@okikio/sharedworker&#x26;bundle" target="_blank" rel="noopener"><img src="https://bundle.js.org/badge-light.svg" alt="Open Bundle"><span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a></p>
<p><a href="https://www.npmjs.com/package/@okikio/sharedworker" target="_blank" rel="noopener">NPM<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> <span style="padding-inline: 1rem">|</span> <a href="https://github.com/okikio/sharedworker#readme" target="_blank" rel="noopener">Github<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> <span style="padding-inline: 1rem">|</span> <a href="https://sharedworker.okikio.dev/" target="_blank" rel="noopener">Docs<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> <span style="padding-inline: 1rem">|</span> <a href="https://github.com/okikio/sharedworker/tree/main/LICENSE" target="_blank" rel="noopener">Licence<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a>  </p>
<p>A small mostly spec. compliant polyfill/ponyfill for <code>SharedWorkers</code>, it acts as a drop in replacement for normal <code>Workers</code>, and supports a similar API surface that matches normal <code>Workers</code>.</p>
<blockquote>
<ul>
<li><a href="https://github.com/sindresorhus/ponyfill" target="_blank" rel="noopener">Ponyfills<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> are seperate modules that are included to replicate the functionality of the original API, but are not required to be used.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Glossary/Polyfill" target="_blank" rel="noopener">Polyfills<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> update the original API on the global scope if it isn't supported in that specific environment or it's feature set is lacking compared to modern variations.</li>
</ul>
</blockquote>
<blockquote>
<p>Check out the <a href="https://blog.okikio.dev/sharedworker" target="_blank" rel="noopener">blog post<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a>, created for it's launch. </p>
</blockquote>

<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
  <h2 id="installation">Installation</h2>
</a>
<pre><code class="language-bash"><span class="hl-0">npm install sharedworker</span>
</code></pre>
<details>
    <summary>Others</summary>

<pre><code class="language-bash"><span class="hl-0">yarn add sharedworker</span>
</code></pre>
<p>or </p>
<pre><code class="language-bash"><span class="hl-0">pnpm install sharedworker</span>
</code></pre>
</details>


<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
  <h2 id="usage">Usage</h2>
</a>
<pre><code class="language-ts"><span class="hl-1">import</span><span class="hl-0"> { SharedWorkerPolyfill </span><span class="hl-1">as</span><span class="hl-0"> SharedWorker } </span><span class="hl-1">from</span><span class="hl-0"> </span><span class="hl-2">"@okikio/sharedworker"</span><span class="hl-0">;</span><br><span class="hl-3">// or </span><br><span class="hl-1">import</span><span class="hl-0"> SharedWorker </span><span class="hl-1">from</span><span class="hl-0"> </span><span class="hl-2">"@okikio/sharedworker"</span><span class="hl-0">;</span>
</code></pre>
<p>You can also use it directly through a script tag:</p>
<pre><code class="language-html"><span class="hl-0">&#x3C;</span><span class="hl-4">script</span><span class="hl-0"> </span><span class="hl-5">src</span><span class="hl-0">=</span><span class="hl-2">"https://unpkg.com/@okikio/sharedworker"</span><span class="hl-0"> </span><span class="hl-5">type</span><span class="hl-0">=</span><span class="hl-2">"module"</span><span class="hl-0">>&#x3C;/</span><span class="hl-4">script</span><span class="hl-0">></span><br><span class="hl-0">&#x3C;</span><span class="hl-4">script</span><span class="hl-0"> </span><span class="hl-5">type</span><span class="hl-0">=</span><span class="hl-2">"module"</span><span class="hl-0">></span><br><span class="hl-0">    </span><span class="hl-3">// You can then use it like this</span><br><span class="hl-0">    </span><span class="hl-1">const</span><span class="hl-0"> { </span><span class="hl-6">SharedWorkerPolyfill</span><span class="hl-0">: </span><span class="hl-5">SharedWorker</span><span class="hl-0"> } </span><span class="hl-1">=</span><span class="hl-0"> window.sharedworker; </span><br><span class="hl-0">&#x3C;/</span><span class="hl-4">script</span><span class="hl-0">></span>
</code></pre>
<p>You can also use it via a CDN, e.g.</p>
<pre><code class="language-ts"><span class="hl-1">import</span><span class="hl-0"> SharedWorker </span><span class="hl-1">from</span><span class="hl-0"> </span><span class="hl-2">"https://cdn.skypack.dev/@okikio/sharedworker"</span><span class="hl-0">;</span><br><span class="hl-3">// or </span><br><span class="hl-1">import</span><span class="hl-0"> SharedWorker </span><span class="hl-1">from</span><span class="hl-0"> </span><span class="hl-2">"https://cdn.jsdelivr.net/npm/@okikio/sharedworker"</span><span class="hl-0">;</span><br><span class="hl-3">// or any number of other CDN's</span>
</code></pre>
<p><code>@okikio/sharedworker</code> supports the same API surfaces as <code>SharedWorker</code> and <code>Worker</code>, except it adds some none spec. compliant properties and methods to the <code>SharedWorkerPolyfill</code> class, that enables devs to use <code>SharedWorker</code>'s on browsers that don't support it.</p>
<p>In order to support browsers that don't natively support <code>SharedWorker</code>'s, the actual worker file needs to be tweaked slightly,</p>
<pre><code class="language-ts"><span class="hl-3">/* </span><br><span class="hl-3"> * All variables and values outside the `start(...)` function are shared between all pages, this behavior can cause unexpected bugs if you're not careful</span><br><span class="hl-3"> */</span><br><span class="hl-1">const</span><span class="hl-0"> </span><span class="hl-7">start</span><span class="hl-0"> </span><span class="hl-1">=</span><span class="hl-0"> (</span><span class="hl-6">port</span><span class="hl-0">) </span><span class="hl-1">=></span><span class="hl-0"> {</span><br><span class="hl-0">    </span><span class="hl-3">// All your normal Worker and SharedWorker stuff can be placed here and should just work, with no extra setup required </span><br><span class="hl-0">    </span><br><span class="hl-0">    </span><span class="hl-3">/** </span><br><span class="hl-3">     * All variables and values inside the `start(...)` function are isolated to each page, and will be allocated seperately per page. </span><br><span class="hl-3">     */</span><br><span class="hl-0">    port.</span><span class="hl-7">onmessage</span><span class="hl-0"> </span><span class="hl-1">=</span><span class="hl-0"> ({ </span><span class="hl-6">data</span><span class="hl-0"> }) </span><span class="hl-1">=></span><span class="hl-0"> {</span><br><span class="hl-0">        console.</span><span class="hl-7">log</span><span class="hl-0">(</span><span class="hl-2">"Cool"</span><span class="hl-0">)</span><br><span class="hl-0">    };</span><br><span class="hl-0">};</span><br><br><span class="hl-0">self.</span><span class="hl-7">onconnect</span><span class="hl-0"> </span><span class="hl-1">=</span><span class="hl-0"> </span><span class="hl-6">e</span><span class="hl-0"> </span><span class="hl-1">=></span><span class="hl-0"> {</span><br><span class="hl-0">    </span><span class="hl-1">let</span><span class="hl-0"> [port] </span><span class="hl-1">=</span><span class="hl-0"> e.ports;</span><br><span class="hl-0">    </span><span class="hl-7">start</span><span class="hl-0">(port);</span><br><span class="hl-0">};</span><br><br><span class="hl-3">// This is the fallback, just in case the browser doesn't support SharedWorkers natively</span><br><span class="hl-1">if</span><span class="hl-0"> (</span><span class="hl-2">"SharedWorkerGlobalScope"</span><span class="hl-0"> </span><span class="hl-1">in</span><span class="hl-0"> self) </span><br><span class="hl-0">    </span><span class="hl-7">start</span><span class="hl-0">(self);</span>
</code></pre>
<blockquote>
<p><em><strong>Note</strong>: make sure to read the comments in the above code carefully to avoid unexpected bugs.</em></p>
</blockquote>

<a href="#showcase" id="showcase" style="color: inherit; text-decoration: none;">
  <h2 id="showcase">Showcase</h2>
</a>
<p>A couple sites that use <code>@okikio/sharedworker</code>:</p>
<ul>
<li><a href="https://astro.build/play" target="_blank" rel="noopener">astro.build/play<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> - <a href="https://github.com/snowpackjs/astro-repl" target="_blank" rel="noopener">GitHub<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a></li>
<li><a href="https://bundle.js.org/" target="_blank" rel="noopener">bundle.js.org<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> - <a href="https://github.com/okikio/bundle" target="_blank" rel="noopener">GitHub<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a></li>
<li>Your site here...</li>
</ul>

<a href="#api" id="api" style="color: inherit; text-decoration: none;">
  <h2 id="api">API</h2>
</a>
<p>The API of <code>@okikio/sharedworker</code> closely match the web <code>SharedWorker</code> API, except that all the major methods and properties of <code>SharedWorker.prototype.port</code> are available directly on <code>SharedWorker.prototype</code> including <code>addEventListener</code> and <code>removeEventListener</code>. </p>
<blockquote>
<p><em><strong>Note:</strong> the normal functionality of the methods and properties that are normally available on <code>SharedWorker.prototype</code> will still be kept intact, in <code>@okikio/sharedworker</code>.</em> </p>
</blockquote>
<p>In addition, the <code>terminate()</code> method was added to <code>@okikio/sharedworker</code>, this allows both the <code>close()</code> method (this is from <code>SharedWorker.prototype.port</code>) and the <code>terminate()</code> method to manually close workers. </p>
<p>Check out the <a href="https://sharedworker.okikio.dev/" target="_blank" rel="noopener">API site<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> for detailed API documentation.</p>

<a href="#browser-support" id="browser-support" style="color: inherit; text-decoration: none;">
  <h2 id="browser-support">Browser Support</h2>
</a>
<table>
<thead>
<tr>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Safari</th>
<th>IE</th>
</tr>
</thead>
<tbody><tr>
<td>4+</td>
<td>12+</td>
<td>4+</td>
<td>4+</td>
<td>10+</td>
</tr>
</tbody></table>
<p>Native support for <code>SharedWorker</code> is not supported at all on Safari and IE, as well as all mobile browsers (excluding Firefox For Android).</p>
<blockquote>
<p><em><strong>Note:</strong> some features of <code>Workers</code> appeared at later versions of the spec., so, I suggest looking into the feature support table for <a href="https://developer.mozilla.org/en-US/docs/Web/API/Worker#browser_compatibility" target="_blank" rel="noopener">Workers<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker#browser_compatibility" target="_blank" rel="noopener">SharedWorkers<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a>.</em> </p>
</blockquote>

<a href="#contributing" id="contributing" style="color: inherit; text-decoration: none;">
  <h2 id="contributing">Contributing</h2>
</a>
<p>I encourage you to use <a href="https://pnpm.io/configuring" target="_blank" rel="noopener">pnpm<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> to contribute to this repo, but you can also use <a href="https://classic.yarnpkg.com/lang/en/" target="_blank" rel="noopener">yarn<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> or <a href="https://npmjs.com/" target="_blank" rel="noopener">npm<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> if you prefer.</p>
<p>Install all necessary packages</p>
<pre><code class="language-bash"><span class="hl-0">npm install</span>
</code></pre>
<p>Then run tests (WIP)</p>
<pre><code class="language-bash"><span class="hl-0">npm </span><span class="hl-5">test</span>
</code></pre>
<p>Build project </p>
<pre><code class="language-bash"><span class="hl-0">npm run build</span>
</code></pre>
<p>Preview API Docs</p>
<pre><code class="language-bash"><span class="hl-0">npm run typedoc </span><span class="hl-1">&#x26;&#x26;</span><span class="hl-0"> npm run preview</span>
</code></pre>
<blockquote>
<p><em><strong>Note</strong>: this project uses <a href="https://www.conventionalcommits.org/en/v1.0.0/" target="_blank" rel="noopener">Conventional Commits<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> standard for commits, so, please format your commits using the rules it sets out.</em></p>
</blockquote>

<a href="#licence" id="licence" style="color: inherit; text-decoration: none;">
  <h2 id="licence">Licence</h2>
</a>
<p>See the <a href="https://github.com/okikio/sharedworker/tree/main/LICENSE" target="_blank" rel="noopener">LICENSE<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a> file for license rights and limitations (MIT).</p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li><li class="tsd-kind-namespace"><a href="modules/External.html">External</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-reference"><a href="modules.html#default" class="tsd-kind-icon">default</a></li><li class="tsd-kind-class"><a href="classes/SharedWorkerPolyfill.html" class="tsd-kind-icon">Shared<wbr>Worker<wbr>Polyfill</a></li><li class="tsd-kind-variable"><a href="modules.html#SharedWorkerSupported" class="tsd-kind-icon">Shared<wbr>Worker<wbr>Supported</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2 id="legend">Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li><li class="tsd-kind-accessor tsd-parent-kind-class"><span class="tsd-kind-icon">Accessor</span></li></ul></div><h2 id="settings">Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank" rel="noopener">TypeDoc<span><span class="external-icon"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 14 14" fill="none"><path d="M1 13L13 1m0 0H5m8 0v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span></span></a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>