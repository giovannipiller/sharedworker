<!doctypehtml><html class=default><meta charset=utf8><meta content="IE=edge"http-equiv=x-ua-compatible><title>@okikio/sharedworker - v1.0.3</title><meta content="Documentation for @okikio/sharedworker - v1.0.3"name=description><meta content="width=device-width,initial-scale=1"name=viewport><link href=assets/style.css rel=stylesheet><link href=assets/highlight.css rel=stylesheet><link href=assets/custom.css rel=stylesheet><script src=assets/search.js async id=search-script></script><body><script>document.body.classList.add(localStorage.getItem("tsd-theme")||"os")</script><header><div class=tsd-page-toolbar><div class=container><div class=table-wrap><div class=table-cell id=tsd-search data-base=.><div class=field><label class="tsd-widget no-caption search"for=tsd-search-field>Search</label><input id=tsd-search-field></div><ul class=results><li class="state loading">Preparing search index...<li class="state failure">The search index is not available</ul><a href=index.html class=title>@okikio/sharedworker - v1.0.3</a></div><div class=table-cell id=tsd-widgets><div id=tsd-filter><a href=# class="tsd-widget no-caption options"data-toggle=options>Options</a><div class=tsd-filter-group><div class=tsd-select id=tsd-filter-visibility><span class=tsd-select-label>All</span><ul class=tsd-select-list><li data-value=public>Public<li data-value=protected>Public/Protected<li class=selected data-value=private>All</ul></div><input id=tsd-filter-inherited type=checkbox checked><label class=tsd-widget for=tsd-filter-inherited>Inherited</label><input id=tsd-filter-externals type=checkbox checked><label class=tsd-widget for=tsd-filter-externals>Externals</label></div></div><a href=# class="tsd-widget no-caption menu"data-toggle=menu>Menu</a></div></div></div></div><div class=tsd-page-title><div class=container><h1 id=okikiosharedworker---v103>@okikio/sharedworker - v1.0.3</h1></div></div></header><div class="container container-main"><div class=row><div class="col-8 col-content"><div class="tsd-panel tsd-typography"><a href=#okikiosharedworker id=okikiosharedworker style=color:inherit;text-decoration:none><h1 id=okikiosharedworker>@okikio/sharedworker</h1></a><p><a href="https://bundle.js.org/?q=@okikio/sharedworker&#38bundle"rel=noopener target=_blank><img alt="Open Bundle"src=https://bundle.js.org/badge-light.svg><span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a><p><a href=https://www.npmjs.com/package/@okikio/sharedworker rel=noopener target=_blank>NPM<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a> <span style=padding-inline:1rem>|</span> <a href=https://github.com/okikio/sharedworker#readme rel=noopener target=_blank>Github<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a> <span style=padding-inline:1rem>|</span> <a href=https://sharedworker.okikio.dev/ rel=noopener target=_blank>Docs<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a> <span style=padding-inline:1rem>|</span> <a href=https://github.com/okikio/sharedworker/tree/main/LICENSE rel=noopener target=_blank>Licence<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a><p>A small mostly spec. compliant polyfill/ponyfill for <code>SharedWorkers</code>, it acts as a drop in replacement for normal <code>Workers</code>, and supports a similar API surface that matches normal <code>Workers</code>.<blockquote><p><a href=https://github.com/sindresorhus/ponyfill rel=noopener target=_blank>Ponyfills<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a> are seperate modules that are included to replicate the functionality of the original API, but are not required to be used, while polyfills are update the original API on the global scope if it isn't supported in that specific environment or it's feature set is lacking compared to modern variations.</blockquote><blockquote><p>Check out the <a href=https://blog.okikio.dev/sharedworker rel=noopener target=_blank>blog post<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a>, created for it's launch.</blockquote><a href=#installation id=installation style=color:inherit;text-decoration:none><h2 id=installation>Installation</h2></a><pre><code class=language-bash><span class=hl-0>npm install sharedworker</span>
</code></pre><details><summary>Others</summary><pre><code class=language-bash><span class=hl-0>yarn add sharedworker</span>
</code></pre><p>or<pre><code class=language-bash><span class=hl-0>pnpm install sharedworker</span>
</code></pre></details><a href=#usage id=usage style=color:inherit;text-decoration:none><h2 id=usage>Usage</h2></a><pre><code class=language-ts><span class=hl-1>import</span><span class=hl-0> { SharedWorkerPolyfill </span><span class=hl-1>as</span><span class=hl-0> SharedWorker } </span><span class=hl-1>from</span><span class=hl-0> </span><span class=hl-2>"@okikio/sharedworker"</span><span class=hl-0>;</span><br><span class=hl-3>// or </span><br><span class=hl-1>import</span><span class=hl-0> SharedWorker </span><span class=hl-1>from</span><span class=hl-0> </span><span class=hl-2>"@okikio/sharedworker"</span><span class=hl-0>;</span>
</code></pre><p>You can also use it directly through a script tag:<pre><code class=language-html><span class=hl-0>&lt;</span><span class=hl-4>script</span><span class=hl-0> </span><span class=hl-5>src</span><span class=hl-0>=</span><span class=hl-2>"https://unpkg.com/@okikio/sharedworker"</span><span class=hl-0> </span><span class=hl-5>type</span><span class=hl-0>=</span><span class=hl-2>"module"</span><span class=hl-0>>&#60/</span><span class=hl-4>script</span><span class=hl-0>></span><br><span class=hl-0>&lt;</span><span class=hl-4>script</span><span class=hl-0> </span><span class=hl-5>type</span><span class=hl-0>=</span><span class=hl-2>"module"</span><span class=hl-0>></span><br><span class=hl-0>    </span><span class=hl-3>// You can then use it like this</span><br><span class=hl-0>    </span><span class=hl-1>const</span><span class=hl-0> { </span><span class=hl-6>SharedWorkerPolyfill</span><span class=hl-0>: </span><span class=hl-5>SharedWorker</span><span class=hl-0> } </span><span class=hl-1>=</span><span class=hl-0> window.sharedworker; </span><br><span class=hl-0>&#60/</span><span class=hl-4>script</span><span class=hl-0>></span>
</code></pre><p>You can also use it via a CDN, e.g.<pre><code class=language-ts><span class=hl-1>import</span><span class=hl-0> SharedWorker </span><span class=hl-1>from</span><span class=hl-0> </span><span class=hl-2>"https://cdn.skypack.dev/@okikio/sharedworker"</span><span class=hl-0>;</span><br><span class=hl-3>// or </span><br><span class=hl-1>import</span><span class=hl-0> SharedWorker </span><span class=hl-1>from</span><span class=hl-0> </span><span class=hl-2>"https://cdn.jsdelivr.net/npm/@okikio/sharedworker"</span><span class=hl-0>;</span><br><span class=hl-3>// or any number of other CDN's</span>
</code></pre><p><code>@okikio/sharedworker</code> supports the same API surface as the <code>SharedWorker</code> and <code>Worker</code> classes, except it adds some none spec. compliant properties and methods to the <code>SharedWorkerPolyfill</code> class, this enables you to use <code>SharedWorker</code>'s on browsers that don't support it.<p>In order to support browsers that don't support <code>SharedWorker</code>'s the actual worker file needs to be setup slightly differently,<pre><code class=language-ts><span class=hl-3>/* </span><br><span class=hl-3> * All variables and values outside the `start(...)` function are shared between all pages, this behavior can cause unexpected bugs if you're not careful</span><br><span class=hl-3> */</span><br><span class=hl-1>const</span><span class=hl-0> </span><span class=hl-7>start</span><span class=hl-0> </span><span class=hl-1>=</span><span class=hl-0> (</span><span class=hl-6>port</span><span class=hl-0>) </span><span class=hl-1>=></span><span class=hl-0> {</span><br><span class=hl-0>    </span><span class=hl-3>// All your normal Worker and SharedWorker stuff should just work</span><br><span class=hl-0>    </span><span class=hl-3>// With no more setup </span><br><span class=hl-0>    </span><br><span class=hl-0>    </span><span class=hl-3>/** </span><br><span class=hl-3>     * All variables and values inside the `start(...)` function are isolated to each page, and will be allocated seperately per page. </span><br><span class=hl-3>     */</span><br><span class=hl-0>    port.</span><span class=hl-7>onmessage</span><span class=hl-0> </span><span class=hl-1>=</span><span class=hl-0> ({ </span><span class=hl-6>data</span><span class=hl-0> }) </span><span class=hl-1>=></span><span class=hl-0> {</span><br><span class=hl-0>        console.</span><span class=hl-7>log</span><span class=hl-0>(</span><span class=hl-2>"Cool"</span><span class=hl-0>)</span><br><span class=hl-0>    };</span><br><span class=hl-0>};</span><br><br><span class=hl-0>self.</span><span class=hl-7>onconnect</span><span class=hl-0> </span><span class=hl-1>=</span><span class=hl-0> </span><span class=hl-6>e</span><span class=hl-0> </span><span class=hl-1>=></span><span class=hl-0> {</span><br><span class=hl-0>    </span><span class=hl-1>let</span><span class=hl-0> [port] </span><span class=hl-1>=</span><span class=hl-0> e.ports;</span><br><span class=hl-0>    </span><span class=hl-7>start</span><span class=hl-0>(port);</span><br><span class=hl-0>};</span><br><br><span class=hl-3>// This is the fallback, just in case the browser doesn't support SharedWorkers</span><br><span class=hl-1>if</span><span class=hl-0> (</span><span class=hl-2>"SharedWorkerGlobalScope"</span><span class=hl-0> </span><span class=hl-1>in</span><span class=hl-0> self) </span><br><span class=hl-0>    </span><span class=hl-7>start</span><span class=hl-0>(self);</span>
</code></pre><blockquote><p><em><strong>Note</strong>: make sure to read the comments in the above code carefully to avoid unexpected bugs.</em></blockquote><a href=#showcase id=showcase style=color:inherit;text-decoration:none><h2 id=showcase>Showcase</h2></a><p>A couple sites that use <code>@okikio/sharedworker</code>:<ul><li><a href=https://astro.build/play rel=noopener target=_blank>astro.build/play<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a> - <a href=https://github.com/snowpackjs/astro-repl rel=noopener target=_blank>GitHub<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a><li><a href=https://bundle.js.org/ rel=noopener target=_blank>bundle.js.org<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a> - <a href=https://github.com/okikio/bundle rel=noopener target=_blank>GitHub<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a><li>Your site here...</ul><a href=#api id=api style=color:inherit;text-decoration:none><h2 id=api>API</h2></a><p>The basics of <code>@okikio/sharedworker</code> rather closely match <code>SharedWorker</code>'s the main differences are that all the major methods and properties of <code>SharedWorker.prototype.port</code> are available directly on <code>SharedWorker.prototype</code> including <code>addEventListener</code> and <code>removeEventListener</code>.<blockquote><p><em><strong>Note:</strong> the normal functionality of the methods and properties that were already there on <code>SharedWorker.prototype</code> will still be kept intact.</em></blockquote><p>In addition, the <code>terminate()</code> method was added to <code>@okikio/sharedworker</code> this allows both the <code>close()</code> method (this is from <code>SharedWorker.prototype.port</code> methods being available directly on <code>SharedWorker.prototype</code>) and the <code>terminate()</code> method to manually close workers.<p>Check out the <a href=https://sharedworker.okikio.dev/ rel=noopener target=_blank>API site<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a> for detailed API documentation.</p><a href=#browser-support id=browser-support style=color:inherit;text-decoration:none><h2 id=browser-support>Browser Support</h2></a><table><thead><tr><th>Chrome<th>Edge<th>Firefox<th>Safari<th>IE<tbody><tr><td>4+<td>12+<td>4+<td>4+<td>10+</table><p>Native support for <code>SharedWorker</code> is not supported at all on Safari and IE, as well as all mobile browsers (excluding Firefox For Android).<blockquote><p><em><strong>Note:</strong> some features of <code>Workers</code> appeared at later versions of the spec., so, I suggest looking into the feature support table for <a href=https://developer.mozilla.org/en-US/docs/Web/API/Worker#browser_compatibility rel=noopener target=_blank>Workers<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a> and <a href=https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker#browser_compatibility rel=noopener target=_blank>SharedWorkers<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a>.</em></blockquote><a href=#contributing id=contributing style=color:inherit;text-decoration:none><h2 id=contributing>Contributing</h2></a><p>I encourage you to use <a href=https://pnpm.io/configuring rel=noopener target=_blank>pnpm<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a> to for this repo, but you can also use <a href=https://classic.yarnpkg.com/lang/en/ rel=noopener target=_blank>yarn<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a> or <a href=https://npmjs.com/ rel=noopener target=_blank>npm<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a> if you prefer.<p>Install all necessary packages<pre><code class=language-bash><span class=hl-0>npm install</span>
</code></pre><p>Then run tests (WIP)<pre><code class=language-bash><span class=hl-0>npm </span><span class=hl-5>test</span>
</code></pre><p>Build project<pre><code class=language-bash><span class=hl-0>npm run build</span>
</code></pre><p>Preview API Docs<pre><code class=language-bash><span class=hl-0>npm run typedoc </span><span class=hl-1>&#38&amp</span><span class=hl-0> npm run preview</span>
</code></pre><a href=#licence id=licence style=color:inherit;text-decoration:none><h2 id=licence>Licence</h2></a><p>See the <a href=https://github.com/okikio/sharedworker/tree/main/LICENSE rel=noopener target=_blank>LICENSE<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a> file for license rights and limitations (MIT).</div></div><div class="col-4 col-menu menu-highlight menu-sticky-wrap"><nav class="tsd-navigation primary"><ul><li class=current><a href=modules.html>Exports</a><li class=tsd-kind-namespace><a href=modules/External.html>External</a></ul></nav><nav class="tsd-navigation menu-sticky secondary"><ul><li class=tsd-kind-reference><a href=modules.html#default class=tsd-kind-icon>default</a><li class=tsd-kind-class><a href=classes/SharedWorkerPolyfill.html class=tsd-kind-icon>Shared<wbr>Worker<wbr>Polyfill</a><li class=tsd-kind-variable><a href=modules.html#SharedWorkerSupported class=tsd-kind-icon>Shared<wbr>Worker<wbr>Supported</a></ul></nav></div></div></div><footer class=with-border-bottom><div class=container><h2 id=legend>Legend</h2><div class=tsd-legend-group><ul class=tsd-legend><li class="tsd-parent-kind-class tsd-kind-constructor"><span class=tsd-kind-icon>Constructor</span><li class="tsd-parent-kind-class tsd-kind-property"><span class=tsd-kind-icon>Property</span><li class="tsd-parent-kind-class tsd-kind-method"><span class=tsd-kind-icon>Method</span><li class="tsd-parent-kind-class tsd-kind-accessor"><span class=tsd-kind-icon>Accessor</span></ul></div><h2 id=settings>Settings</h2><p>Theme <select id=theme><option value=os>OS<option value=light>Light<option value=dark>Dark</select></div></footer><div class="container tsd-generator"><p>Generated using <a href=https://typedoc.org/ rel=noopener target=_blank>TypeDoc<span><span class=external-icon><svg fill=none height=10 viewBox="0 0 14 14"width=10 xmlns=http://www.w3.org/2000/svg><path d="M1 13L13 1m0 0H5m8 0v7"stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></span></span></a></div><div class=overlay></div><script src=assets/main.js></script>